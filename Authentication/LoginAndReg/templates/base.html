<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Django Authentication{% endblock %}</title>
    <link rel="icon" type="image/png" href="{% static 'favicon.png' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Local FontAwesome (preferred, offline-safe) -->
    <link href="{% static 'vendor/fontawesome/fontawesome-free-6.5.2-web/css/all.min.css' %}" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        html, body { 
            height: 100%; 
            background: var(--bg-gradient);
            background-attachment: fixed;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        
        /* Apply Poppins font to all elements */
        * {
            font-family: 'Poppins', sans-serif !important;
        }
        
        :root {
            /* Teal + Blue palette (slightly darkened from #70C1B3 and #247B9F) */
            --primary-color: #62AA9D; /* darkened #70C1B3 */
            --secondary-color: #1F6C8C; /* darkened #247B9F */
            --accent-color: #2A7F96;
            --light-pink: var(--primary-color);
            --dark-plum: var(--secondary-color);
            
            /* Gradient using the palette */
            --bg-gradient: linear-gradient(135deg, var(--primary-color) 0%, #2A7F96 50%, var(--secondary-color) 100%);
            --card-bg: rgba(98, 170, 157, 0.15);
            --card-border: rgba(255, 255, 255, 0.2);
            
            /* Text */
            --text-primary: #ffffff;
            --text-secondary: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.8);
            
            /* UI */
            --shadow: rgba(0, 0, 0, 0.4);
            --border: rgba(255, 255, 255, 0.2);
            
            /* Status colors mapped to palette */
            --success-color: var(--primary-color);
            --warning-color: #2F8C8F;
            --danger-color: #20647D;
            --info-color: var(--secondary-color);
        }
        
        /* Dark Theme Variables - Using Same Orange/Blue Colors */
        [data-theme="dark"] {
            /* Darker variants for dark theme */
            --primary-color: #539085;
            --secondary-color: #1A5B77;
            --accent-color: #246E83;
            
            --bg-gradient: linear-gradient(135deg, var(--primary-color) 0%, #246E83 50%, var(--secondary-color) 100%);
            --card-bg: rgba(83, 144, 133, 0.25);
            --card-border: rgba(255, 255, 255, 0.2);
            
            --text-primary: #ffffff;
            --text-secondary: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.8);
            
            --shadow: rgba(0, 0, 0, 0.8);
            --border: rgba(255, 255, 255, 0.2);
            
            --success-color: var(--primary-color);
            --warning-color: #2A7F96;
            --danger-color: #184B60;
            --info-color: var(--secondary-color);
        }
        
        /* Legacy variables for compatibility */
        :root {
            --dark-text-primary: var(--text-primary);
            --dark-text-secondary: var(--text-secondary);
            --dark-text-muted: var(--text-muted);
            --dark-card-bg: var(--card-bg);
            --dark-border: var(--border);
            --dark-shadow: var(--shadow);
        }
        
        /* Light theme text fixes */
        .form-label,
        .input-group-text,
        .form-floating label,
        label[for] {
            color: #ffffff !important;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7);
            margin-bottom: 0.5rem;
            font-family: 'Poppins', sans-serif !important;
        }
        
        /* Ensure all titles and labels are visible in light theme */
        h1, h2, h3, h4, h5, h6 {
            color: #ffffff !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7);
            font-family: 'Poppins', sans-serif !important;
        }
        
        p, span, div, strong, small, .text-muted, .activity-time, .activity-item p, .activity-item span {
            color: rgba(255, 255, 255, 0.95) !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            font-family: 'Poppins', sans-serif !important;
        }
        
        /* Ensure all icons are visible */
        i, .fas, .fab, .far, .fal, .fad, .fa {
            color: rgba(255, 255, 255, 0.9) !important;
            display: inline-block !important;
            text-rendering: auto !important;
            -webkit-font-smoothing: antialiased !important;
        }
        
        /* Icon fallback styles - only when needed */
        i[data-fallback]:not(.fa-loaded)::after {
            content: attr(data-fallback);
            font-family: Arial, sans-serif !important;
            font-size: 14px !important;
            font-weight: normal !important;
        }
        
        /* Icon colors for specific contexts */
        .btn i, .card-header i, .navbar i, .pill-navbar i {
            color: rgba(255, 255, 255, 0.95) !important;
        }
        
        /* Alert icons with theme colors */
        .alert-success .alert-icon {
            color: var(--success-color) !important;
        }
        
        .alert-warning .alert-icon {
            color: var(--warning-color) !important;
        }
        
        .alert-danger .alert-icon {
            color: var(--danger-color) !important;
        }
        
        .alert-info .alert-icon {
            color: var(--info-color) !important;
        }
        
        /* Smart card background text colors */
        .card {
            background: var(--card-bg);
        }
        
        .card.light-bg {
            background: rgba(255, 255, 255, 0.9);
        }
        
        .card.light-bg .card-body,
        .card.light-bg .card-header,
        .card.light-bg .card-footer {
            color: #000000 !important;
        }
        
        .card.light-bg .card-body p,
        .card.light-bg .card-body span,
        .card.light-bg .card-body div,
        .card.light-bg .text-muted {
            color: rgba(0, 0, 0, 0.8) !important;
        }
        
        .card.light-bg .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: #ffffff !important;
        }
        
        .text-muted {
            color: rgba(255, 255, 255, 0.8) !important;
            font-family: 'Poppins', sans-serif !important;
        }

        
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-gradient);
            background-attachment: fixed;
            position: relative;
            overflow: hidden;
            animation: gradientShift 20s ease-in-out infinite;
            padding-top: 130px; /* increased space for fixed navbar */
            transition: all 0.3s ease;
        }
        
        @keyframes gradientShift {
            0%, 100% {
                background: var(--bg-gradient);
            }
            25% {
                opacity: 0.9;
            }
            50% {
                opacity: 1;
            }
            75% {
                opacity: 0.95;
            }
        }
        
        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="10" cy="60" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="90" cy="40" r="0.5" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
            animation: float 20s ease-in-out infinite;
        }
        
        .auth-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(240, 147, 251, 0.2) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(118, 75, 162, 0.1) 0%, transparent 50%);
            animation: shimmer 8s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-10px) rotate(1deg); }
            66% { transform: translateY(5px) rotate(-1deg); }
        }
        
        @keyframes shimmer {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }
        
        .auth-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            box-shadow: 0 30px 60px var(--shadow), 
                        0 0 0 1px var(--card-border),
                        inset 0 1px 0 var(--card-border);
            padding: 2.25rem;
            width: 100%;
            max-width: 1200px; /* expanded width */
            position: relative;
            z-index: 1;
            border: 1px solid var(--card-border);
            animation: cardFloat 6s ease-in-out infinite;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--text-primary);
        }
        
        /* Enhanced text contrast for all themes */
        .auth-card h1, .auth-card h2, .auth-card h3, .auth-card h4, .auth-card h5, .auth-card h6 {
            color: var(--text-primary) !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .auth-card p, .auth-card label, .auth-card span, .auth-card div {
            color: var(--text-secondary) !important;
        }
        
        .auth-card .text-muted {
            color: var(--text-muted) !important;
        }

        @media (max-width: 992px) {
            .auth-card { max-width: 720px; padding: 2rem; }
        }

        @media (max-width: 576px) {
            .auth-card { max-width: 95%; padding: 1.5rem; }
        }

        /* Pill Navbar */
        .pill-navbar-wrapper { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1100; width: min(95%, 1100px); }
        .pill-navbar {
            display: flex;
            align-items: center;
            gap: 22px;
            padding: 10px 14px;
            border-radius: 999px;
            /* Glassy, blended background */
            background: linear-gradient(
                180deg,
                rgba(26, 27, 31, 0.55) 0%,
                rgba(16, 17, 20, 0.45) 100%
            );
            backdrop-filter: blur(12px) saturate(120%);
            -webkit-backdrop-filter: blur(12px) saturate(120%);
            box-shadow: 0 10px 24px rgba(0,0,0,0.28), inset 0 1px 0 rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.08);
            color: var(--dark-text-secondary);
            width: 100%;
        }
        .pill-left {
            width: 38px; height: 38px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.12), rgba(0,0,0,0.15));
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.12);
        }
        .pill-left i { color: var(--secondary-color); }
        .pill-toggle {
            display: none; width: 38px; height: 38px; border-radius: 10px;
            align-items: center; justify-content: center;
            background: rgba(255,255,255,0.12); border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }
        .pill-toggle span { display: block; width: 20px; height: 2px; background: #fff; position: relative; }
        .pill-toggle span::before, .pill-toggle span::after { content: ''; position: absolute; left: 0; right: 0; height: 2px; background: #fff; }
        .pill-toggle span::before { top: -6px; }
        .pill-toggle span::after { top: 6px; }
        .pill-link { text-decoration: none; color: var(--dark-text-secondary); font-weight: 600; opacity: 0.9; position: relative; }
        .pill-link:hover { color: var(--primary-color); opacity: 1; }
        .pill-link.active {
            color: #fff;
            text-shadow: 0 0 6px rgba(243, 144, 79, 0.9), 0 0 14px rgba(243, 144, 79, 0.6);
            animation: navGlow 2s ease-in-out infinite alternate;
        }
        @keyframes navGlow {
            0% { text-shadow: 0 0 4px rgba(243, 144, 79, 0.6), 0 0 8px rgba(243, 144, 79, 0.4); }
            100% { text-shadow: 0 0 10px rgba(243, 144, 79, 1), 0 0 20px rgba(243, 144, 79, 0.8); }
        }
        .pill-link.active::after { content: none; }
        .pill-spacer { flex: 1 1 auto; }
        .pill-end {
            padding: 8px 16px; border-radius: 999px; 
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(240,240,240,0.98));
            color: #1a1a1a !important;
            box-shadow: 0 6px 16px rgba(0,0,0,0.25), inset 0 1px 0 rgba(255,255,255,0.9);
            font-weight: 700; display: flex; align-items: center; gap: 6px;
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
            min-width: 100px;
            justify-content: center;
            max-width: 120px;
            white-space: nowrap;
            overflow: hidden;
        }
        .pill-end span {
            color: #1a1a1a !important;
            font-size: 14px;
            text-shadow: none !important;
            font-weight: 700;
        }
        .pill-end a { 
            color: #1a1a1a !important; 
            text-decoration: none; 
            font-weight: 700;
            text-shadow: none !important;
        }
        .pill-end a:hover { 
            text-decoration: underline; 
            color: var(--primary-color) !important;
        }
        .logout-btn {
            padding: 10px 16px !important;
            border-radius: 999px !important;
            background: linear-gradient(135deg, rgba(255,107,107,0.9), rgba(255,82,82,0.8)) !important;
            color: #ffffff !important;
            transition: all 0.3s ease !important;
            text-decoration: none !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 8px !important;
            border: 1px solid rgba(255,107,107,0.5) !important;
            font-weight: 700 !important;
            box-shadow: 0 4px 12px rgba(255,107,107,0.3) !important;
            backdrop-filter: blur(10px) !important;
        }
        .logout-btn:hover {
            background: linear-gradient(135deg, rgba(255,82,82,1), rgba(255,107,107,0.9)) !important;
            color: #ffffff !important;
            text-decoration: none !important;
            transform: scale(1.08) !important;
            border-color: rgba(255,82,82,0.8) !important;
            box-shadow: 0 6px 20px rgba(255,107,107,0.5) !important;
        }
        .logout-btn i {
            font-size: 14px !important;
            color: inherit !important;
        }
        .logout-text {
            font-size: 13px !important;
            color: #ffffff !important;
            text-shadow: none !important;
            font-weight: inherit !important;
        }
        
        /* Login button styling */
        .login-btn {
            padding: 10px 16px !important;
            border-radius: 999px !important;
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(240,240,240,0.98)) !important;
            color: #1a1a1a !important;
            transition: all 0.3s ease !important;
            text-decoration: none !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            border: 1px solid rgba(255,255,255,0.3) !important;
            font-weight: 700 !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2) !important;
            backdrop-filter: blur(10px) !important;
        }
        
        .login-btn:hover {
            background: linear-gradient(135deg, rgba(255,255,255,1), rgba(240,240,240,1)) !important;
            color: var(--primary-color) !important;
            text-decoration: none !important;
            transform: scale(1.05) !important;
            box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
        }
        
        /* Subtle pulse animation for logout button */
        @keyframes logoutPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255,107,107,0.4); }
            50% { box-shadow: 0 0 0 4px rgba(255,107,107,0.1); }
        }
        
        .logout-btn {
            animation: logoutPulse 3s infinite;
        }
        
        /* Responsive navbar adjustments */
        @media (max-width: 768px) {
            .pill-navbar {
                gap: 10px;
                padding: 8px 12px;
                flex-wrap: wrap;
            }
            .pill-toggle { display: inline-flex; }
            .pill-links { display: none; width: 100%; gap: 12px; flex-wrap: wrap; }
            .pill-links.show { display: flex; }
            .pill-end {
                min-width: 140px;
                max-width: 200px;
                padding: 6px 12px;
            }
            .pill-end span {
                font-size: 12px;
                max-width: 100px;
                overflow: hidden;
                text-overflow: ellipsis;
            }
            .pill-link {
                font-size: 14px;
            }
            .logout-text {
                display: none;
            }
            .auth-container {
                padding-top: 110px; /* less space on tablets */
            }
        }
        
        @media (max-width: 480px) {
            .pill-navbar-wrapper {
                width: 98%;
            }
            .pill-navbar {
                gap: 8px;
                padding: 6px 10px;
                flex-wrap: wrap;
            }
            .pill-navbar::-webkit-scrollbar { height: 6px; }
            .pill-navbar::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 999px; }
            .pill-end {
                min-width: 120px;
                max-width: 150px;
                padding: 4px 8px;
            }
            .pill-end span {
                font-size: 11px;
                max-width: 80px;
            }
            .pill-link {
                font-size: 13px;
            }
            .logout-text {
                display: none;
            }
            .auth-container {
                padding-top: 100px; /* minimal space on mobile */
            }
        }
        
        .auth-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 40px 80px var(--dark-shadow), 
                        0 0 0 1px var(--primary-color),
                        inset 0 1px 0 rgba(233, 69, 96, 0.3);
        }
        
        @keyframes cardFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }
        
        /* Enhanced floating orbs */
        .floating-orb {
            position: fixed;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            pointer-events: none;
            z-index: -1;
        }
        
        .orb-1 {
            width: 120px;
            height: 120px;
            top: 15%;
            left: 8%;
            animation: floatOrb1 25s ease-in-out infinite;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, rgba(240, 147, 251, 0.1) 100%);
        }
        
        .orb-2 {
            width: 80px;
            height: 80px;
            top: 70%;
            right: 12%;
            animation: floatOrb2 30s ease-in-out infinite;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, rgba(118, 75, 162, 0.15) 100%);
        }
        
        .orb-3 {
            width: 60px;
            height: 60px;
            bottom: 25%;
            left: 20%;
            animation: floatOrb3 20s ease-in-out infinite;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.12) 0%, rgba(102, 126, 234, 0.1) 100%);
        }
        
        @keyframes floatOrb1 {
            0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); }
            25% { transform: translate(30px, -20px) rotate(90deg) scale(1.1); }
            50% { transform: translate(-15px, -40px) rotate(180deg) scale(0.9); }
            75% { transform: translate(40px, -10px) rotate(270deg) scale(1.05); }
        }
        
        @keyframes floatOrb2 {
            0%, 100% { transform: translate(0, 0) rotate(0deg) scale(1); }
            33% { transform: translate(-25px, 30px) rotate(120deg) scale(1.2); }
            66% { transform: translate(20px, -25px) rotate(240deg) scale(0.8); }
        }
        
        @keyframes floatOrb3 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-30px, -35px) scale(1.3); }
        }
        
        /* Theme transition styles */
        .theme-transitioning * {
            transition: background-color 0.3s ease, 
                       color 0.3s ease, 
                       border-color 0.3s ease, 
                       box-shadow 0.3s ease !important;
        }
        
        /* Enhanced text contrast for all UI elements */
        [data-theme="dark"] * {
            color: inherit;
        }
        
        [data-theme="dark"] h1, 
        [data-theme="dark"] h2, 
        [data-theme="dark"] h3, 
        [data-theme="dark"] h4, 
        [data-theme="dark"] h5, 
        [data-theme="dark"] h6 {
            color: #ffffff !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        [data-theme="dark"] p,
        [data-theme="dark"] span,
        [data-theme="dark"] div,
        [data-theme="dark"] label,
        [data-theme="dark"] strong,
        [data-theme="dark"] small,
        [data-theme="dark"] .text-muted,
        [data-theme="dark"] .activity-time,
        [data-theme="dark"] .activity-item p,
        [data-theme="dark"] .activity-item span {
            color: #ffffff !important;
        }
        
        /* Dark theme icon visibility */
        [data-theme="dark"] i,
        [data-theme="dark"] .fas,
        [data-theme="dark"] .fab,
        [data-theme="dark"] .far,
        [data-theme="dark"] .fal,
        [data-theme="dark"] .fad,
        [data-theme="dark"] .fa {
            color: rgba(255, 255, 255, 0.9) !important;
        }
        
        [data-theme="dark"] .btn i,
        [data-theme="dark"] .card-header i,
        [data-theme="dark"] .navbar i {
            color: rgba(255, 255, 255, 0.95) !important;
        }
        
        /* Specific fixes for form labels and input titles */
        [data-theme="dark"] .form-label,
        [data-theme="dark"] .input-group-text,
        [data-theme="dark"] .form-floating label,
        [data-theme="dark"] label[for] {
            color: #ffffff !important;
            font-weight: 600;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        [data-theme="dark"] .text-muted {
            color: #94a3b8 !important;
        }
        
        [data-theme="dark"] .btn {
            color: #ffffff !important;
        }
        
        [data-theme="dark"] .form-control {
            background: rgba(26, 26, 46, 0.9) !important;
            border-color: rgba(255, 255, 255, 0.2) !important;
            color: #ffffff !important;
        }
        
        [data-theme="dark"] .form-control::placeholder {
            color: #94a3b8 !important;
        }
        
        [data-theme="dark"] .navbar-brand,
        [data-theme="dark"] .nav-link {
            color: #ffffff !important;
        }
        
        /* Additional text visibility fixes */
        [data-theme="dark"] .card-title,
        [data-theme="dark"] .card-header,
        [data-theme="dark"] .modal-title,
        [data-theme="dark"] .alert,
        [data-theme="dark"] .badge {
            color: #ffffff !important;
        }
        
        [data-theme="dark"] .card-text,
        [data-theme="dark"] .card-body p,
        [data-theme="dark"] .modal-body p {
            color: #e2e8f0 !important;
        }
        
        /* Fix for any remaining blended text */
        [data-theme="dark"] * {
            text-shadow: none;
        }
        
        [data-theme="dark"] h1, 
        [data-theme="dark"] h2, 
        [data-theme="dark"] h3, 
        [data-theme="dark"] h4, 
        [data-theme="dark"] h5, 
        [data-theme="dark"] h6,
        [data-theme="dark"] .form-label,
        [data-theme="dark"] label {
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7) !important;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 15px;
            padding: 15px 30px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 20px rgba(137, 37, 62, 0.4), 
                        inset 0 1px 0 rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            color: #ffffff !important;
            font-family: 'Poppins', sans-serif !important;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 30px rgba(137, 37, 62, 0.5), 
                        inset 0 1px 0 rgba(255, 255, 255, 0.3);
            color: #ffffff !important;
        }
        
        .btn-primary:active {
            transform: translateY(-1px) scale(1.02);
        }
        
        .btn-outline-primary {
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            padding: 10px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-outline-primary:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }
        
        .btn-facebook {
            background: linear-gradient(135deg, #3b5998, #2d4373);
            border: none;
            color: white;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(59, 89, 152, 0.3);
        }
        
        .btn-facebook:hover {
            background: linear-gradient(135deg, #2d4373, #3b5998);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 89, 152, 0.4);
            color: white;
        }
        
        .btn-outline-info {
            color: var(--light-pink);
            border: 2px solid var(--light-pink);
            border-radius: 12px;
            padding: 10px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-outline-info:hover {
            background: var(--light-pink);
            color: white;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #229954);
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #229954, var(--success-color));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #e67e22);
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #e67e22, var(--warning-color));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(243, 156, 18, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #c0392b);
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        .btn-danger:hover {
            background: linear-gradient(135deg, #c0392b, var(--danger-color));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }
        
        .form-control {
            border: 2px solid var(--dark-border-light);
            border-radius: 15px;
            padding: 15px 20px;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            position: relative;
            color: #000000 !important;
        }
        
        /* Dark background form controls */
        .form-control.dark-bg {
            background: rgba(22, 33, 62, 0.8);
            color: #ffffff !important;
        }
        
        .form-control::placeholder {
            color: rgba(0, 0, 0, 0.6) !important;
            opacity: 0.8;
        }
        
        .form-control.dark-bg::placeholder {
            color: rgba(255, 255, 255, 0.7) !important;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.3rem rgba(243, 144, 79, 0.3), 
                        0 8px 25px rgba(243, 144, 79, 0.2);
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-2px);
            color: #000000 !important;
        }
        
        .form-control.dark-bg:focus {
            background: rgba(22, 33, 62, 0.9);
            color: #ffffff !important;
        }
        
        .form-control:hover {
            border-color: var(--secondary-color);
            transform: translateY(-1px);
        }
        
        /* Smart text color based on background */
        input[type="text"], 
        input[type="password"], 
        input[type="email"], 
        input[type="number"],
        textarea {
            color: #000000 !important;
            background-color: rgba(255, 255, 255, 0.9) !important;
        }
        
        input[type="text"].dark-bg, 
        input[type="password"].dark-bg, 
        input[type="email"].dark-bg, 
        input[type="number"].dark-bg,
        textarea.dark-bg {
            color: #ffffff !important;
            background-color: rgba(22, 33, 62, 0.8) !important;
        }
        
        input[type="text"]:focus, 
        input[type="password"]:focus, 
        input[type="email"]:focus, 
        input[type="number"]:focus,
        textarea:focus {
            color: #000000 !important;
            background-color: rgba(255, 255, 255, 0.95) !important;
        }
        
        input[type="text"].dark-bg:focus, 
        input[type="password"].dark-bg:focus, 
        input[type="email"].dark-bg:focus, 
        input[type="number"].dark-bg:focus,
        textarea.dark-bg:focus {
            color: #ffffff !important;
            background-color: rgba(22, 33, 62, 0.9) !important;
        }
        
        input[type="text"]::placeholder, 
        input[type="password"]::placeholder, 
        input[type="email"]::placeholder, 
        input[type="number"]::placeholder,
        textarea::placeholder {
            color: rgba(0, 0, 0, 0.6) !important;
            opacity: 0.8;
        }
        
        input[type="text"].dark-bg::placeholder, 
        input[type="password"].dark-bg::placeholder, 
        input[type="email"].dark-bg::placeholder, 
        input[type="number"].dark-bg::placeholder,
        textarea.dark-bg::placeholder {
            color: rgba(255, 255, 255, 0.7) !important;
        }
        
        /* Password Toggle Styling */
        .password-toggle-container {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .password-toggle-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--dark-text-muted);
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: all 0.3s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
        }
        
        .password-toggle-btn:hover {
            color: var(--primary-color);
            background: rgba(233, 69, 96, 0.1);
            transform: translateY(-50%) scale(1.1);
        }
        
        .password-toggle-btn:focus {
            outline: none;
            color: var(--primary-color);
            background: rgba(233, 69, 96, 0.2);
        }
        
        .password-toggle-btn i {
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .password-toggle-btn:hover i {
            transform: scale(1.1);
        }
        
        .form-label {
            color: var(--dark-text-secondary);
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .alert {
            border-radius: 15px;
            border: none;
            padding: 20px 24px;
            margin-bottom: 25px;
            font-size: 16px;
            font-weight: 500;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            animation: alertSlideIn 0.5s ease-out;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Poppins', sans-serif !important;
        }
        
        .alert::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.8s;
        }
        
        .alert:hover::before {
            left: 100%;
        }
        
        .alert:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
        }
        
        .alert-info {
            background: linear-gradient(135deg, rgba(59, 67, 113, 0.25), rgba(243, 144, 79, 0.1));
            color: #ffffff !important;
            border: 2px solid rgba(59, 67, 113, 0.3);
            border-left: 6px solid var(--info-color);
        }
        
        .alert-info .alert-icon {
            color: var(--info-color);
            text-shadow: 0 0 10px rgba(59, 67, 113, 0.5);
        }
        
        .alert-warning {
            background: linear-gradient(135deg, rgba(232, 130, 93, 0.25), rgba(59, 67, 113, 0.1));
            color: #ffffff !important;
            border: 2px solid rgba(232, 130, 93, 0.3);
            border-left: 6px solid var(--warning-color);
            font-weight: 600;
        }
        
        .alert-warning .alert-icon {
            color: var(--warning-color);
            text-shadow: 0 0 10px rgba(232, 130, 93, 0.5);
        }
        
        .alert-success {
            background: linear-gradient(135deg, rgba(243, 144, 79, 0.25), rgba(59, 67, 113, 0.1));
            color: #ffffff !important;
            border: 2px solid rgba(243, 144, 79, 0.3);
            border-left: 6px solid var(--success-color);
        }
        
        .alert-success .alert-icon {
            color: var(--success-color);
            text-shadow: 0 0 10px rgba(243, 144, 79, 0.5);
        }
        
        .alert-danger {
            background: linear-gradient(135deg, rgba(200, 118, 107, 0.25), rgba(59, 67, 113, 0.1));
            color: #ffffff !important;
            border: 2px solid rgba(200, 118, 107, 0.3);
            border-left: 6px solid var(--danger-color);
        }
        
        .alert-danger .alert-icon {
            color: var(--danger-color);
            text-shadow: 0 0 10px rgba(200, 118, 107, 0.5);
        }
        
        /* New black alert variant */
        .alert-dark {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.55));
            color: #ffffff !important;
            border: 2px solid rgba(255, 255, 255, 0.08);
            border-left: 6px solid #000000;
        }
        
        .alert-dark .alert-icon {
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.15);
        }
        
        .alert-icon {
            font-size: 20px;
            margin-right: 12px;
            vertical-align: middle;
            display: inline-block;
            animation: iconPulse 2s ease-in-out infinite;
        }
        
        .alert-content {
            display: inline-block;
            vertical-align: middle;
            line-height: 1.4;
        }
        
        .alert-dismissible .btn-close {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.8;
            transition: all 0.3s ease;
        }
        
        .alert-dismissible .btn-close:hover {
            background: rgba(255, 255, 255, 0.3);
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
        }
        
        @keyframes alertSlideIn {
            0% {
                opacity: 0;
                transform: translateY(-30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes iconPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }
        
        .qr-code-container {
            text-align: center;
            margin: 1.5rem 0;
            padding: 20px;
            background: linear-gradient(135deg, rgba(233, 69, 96, 0.2), rgba(22, 33, 62, 0.4));
            border-radius: 12px;
            border: 2px dashed var(--primary-color);
        }
        
        .qr-code-container img {
            max-width: 200px;
            border: 3px solid var(--primary-color);
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(233, 69, 96, 0.3);
        }
        
        .card {
            border: 1px solid var(--dark-border-light);
            border-radius: 15px;
            box-shadow: 0 8px 25px var(--dark-shadow);
            background: var(--dark-card-bg);
            backdrop-filter: blur(15px);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px var(--dark-shadow);
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: #ffffff !important;
            border-radius: 15px 15px 0 0;
            border: none;
            padding: 20px;
        }
        
        .card-body {
            padding: 25px;
        }
        
        h1, h2, h3, h4, h5, h6 {
            color: var(--dark-color);
            font-weight: 700;
        }
        
        .text-primary {
            color: var(--primary-color) !important;
        }
        
        .text-success {
            color: var(--success-color) !important;
        }
        
        .text-warning {
            color: var(--warning-color) !important;
        }
        
        .text-danger {
            color: var(--danger-color) !important;
        }
        
        .text-muted {
            color: var(--dark-text-muted) !important;
        }
        
        .text-light-pink {
            color: var(--light-pink) !important;
        }
        
        .text-dark-plum {
            color: var(--dark-plum) !important;
        }
        
        .list-unstyled li {
            padding: 5px 0;
            color: var(--dark-text-secondary);
        }
        
        .list-unstyled li i {
            margin-right: 10px;
        }
        
        .modal-content {
            border-radius: 15px;
            border: none;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: #ffffff !important;
            border-radius: 15px 15px 0 0;
            border: none;
        }
        
        .btn-close {
            filter: invert(1);
        }
        
        /* Animation for form elements */
        .form-control, .btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Hover effects for cards */
        .card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--light-pink);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
        
        /* Floating particles */
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            pointer-events: none;
            animation: particleFloat 20s linear infinite;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .particle:nth-child(1) { width: 4px; height: 4px; left: 10%; animation-delay: 0s; }
        .particle:nth-child(2) { width: 6px; height: 6px; left: 20%; animation-delay: 2s; }
        .particle:nth-child(3) { width: 3px; height: 3px; left: 30%; animation-delay: 4s; }
        .particle:nth-child(4) { width: 5px; height: 5px; left: 40%; animation-delay: 6s; }
        .particle:nth-child(5) { width: 4px; height: 4px; left: 50%; animation-delay: 8s; }
        .particle:nth-child(6) { width: 7px; height: 7px; left: 60%; animation-delay: 10s; }
        .particle:nth-child(7) { width: 3px; height: 3px; left: 70%; animation-delay: 12s; }
        .particle:nth-child(8) { width: 5px; height: 5px; left: 80%; animation-delay: 14s; }
        .particle:nth-child(9) { width: 4px; height: 4px; left: 90%; animation-delay: 16s; }
        
        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Enhanced text effects - All text white */
        h1, h2, h3, h4, h5, h6 {
            color: #ffffff !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            animation: textGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes textGlow {
            0% { filter: drop-shadow(0 0 5px rgba(243, 144, 79, 0.3)); }
            100% { filter: drop-shadow(0 0 15px rgba(243, 144, 79, 0.6)); }
        }
        
        /* Enhanced card hover effects */
        .card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.8s;
        }
        
        .card:hover::before {
            left: 100%;
        }
        
        .card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        /* Enhanced Dark Theme - Now Default */

        /* Global responsive grid utility */
        .responsive-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.25rem; }
        @media (max-width: 768px) { .responsive-grid { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; } }
        @media (max-width: 480px) { .responsive-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 0.75rem; } }
        
        /* Color Scheme Variations */
        [data-theme="neon"] {
            --primary-color: #00ff88;
            --secondary-color: #ff0080;
            --accent-color: #00ffff;
            --light-pink: #ff6b9d;
            --dark-plum: #8b5cf6;
        }
        
        [data-theme="ocean"] {
            --primary-color: #00d4ff;
            --secondary-color: #0099ff;
            --accent-color: #00ff88;
            --light-pink: #66ccff;
            --dark-plum: #0066cc;
        }
        
        [data-theme="sunset"] {
            --primary-color: #ff6b35;
            --secondary-color: #f7931e;
            --accent-color: #ffd700;
            --light-pink: #ff8c69;
            --dark-plum: #ff4757;
        }
        
        /* Enhanced Theme Toggle Button */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--dark-card-bg);
            border: 1px solid var(--dark-border);
            border-radius: 50%;
            width: 55px;
            height: 55px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 25px var(--dark-shadow);
            backdrop-filter: blur(15px);
            color: var(--dark-text-secondary);
        }
        
        .theme-toggle:hover {
            transform: scale(1.15) rotate(180deg);
            box-shadow: 0 12px 35px var(--dark-shadow);
            border-color: var(--primary-color);
        }
        
        .theme-toggle i {
            font-size: 22px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .theme-toggle:hover i {
            color: var(--primary-color);
            text-shadow: 0 0 10px rgba(233, 69, 96, 0.5);
        }
        
        /* Logout Link Styling */
        .logout-link {
            color: #ff6b6b !important;
            font-weight: 700 !important;
            transition: all 0.3s ease;
        }
        
        .logout-link:hover {
            color: #ff5252 !important;
            transform: scale(1.05);
            text-shadow: 0 0 8px rgba(255, 107, 107, 0.5);
        }
        
        .logout-link i {
            margin-right: 6px;
            transition: all 0.3s ease;
        }
        
        .logout-link:hover i {
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }
        
        /* Custom Confirmation Modal */
        .logout-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: fadeIn 0.3s ease-out;
        }
        
        .logout-modal.show {
            display: flex;
        }
        
        .logout-modal-content {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 107, 107, 0.3);
            animation: slideIn 0.3s ease-out;
            position: relative;
        }
        
        .logout-modal-icon {
            font-size: 48px;
            color: #ff6b6b;
            margin-bottom: 20px;
            animation: iconBounce 0.6s ease-out;
        }
        
        .logout-modal h3 {
            color: #ffffff !important;
            margin-bottom: 15px;
            font-size: 24px;
            font-weight: 700;
        }
        
        .logout-modal p {
            color: rgba(255, 255, 255, 0.9) !important;
            margin-bottom: 25px;
            font-size: 16px;
            line-height: 1.5;
        }
        
        .logout-modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .logout-confirm-btn {
            background: linear-gradient(135deg, #ff6b6b, #ff5252);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }
        
        .logout-confirm-btn:hover {
            background: linear-gradient(135deg, #ff5252, #ff6b6b);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }
        
        .logout-cancel-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logout-cancel-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(-50px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        @keyframes iconBounce {
            0% { transform: scale(0.3); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Responsive Design for Mobile */
        @media (max-width: 768px) {
            .alert {
                padding: 16px 18px;
                font-size: 14px;
                margin-bottom: 20px;
            }
            
            .alert-icon {
                font-size: 18px;
                margin-right: 10px;
            }
            
            .logout-modal-content {
                padding: 25px 20px;
                margin: 20px;
            }
            
            .logout-modal-icon {
                font-size: 40px;
                margin-bottom: 15px;
            }
            
            .logout-modal h3 {
                font-size: 20px;
            }
            
            .logout-modal p {
                font-size: 14px;
            }
            
            .logout-modal-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .logout-confirm-btn,
            .logout-cancel-btn {
                width: 100%;
                padding: 14px 20px;
            }
        }
        
        @media (max-width: 480px) {
            .alert {
                padding: 14px 16px;
                font-size: 13px;
            }
            
            .alert-icon {
                font-size: 16px;
                margin-right: 8px;
            }
            
            .logout-modal-content {
                padding: 20px 15px;
            }
        }
    </style>
    
</head>
<body>
    <!-- Enhanced Theme Toggle Button -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark/Light Theme">
        <i id="theme-icon" class="fa-solid fa-moon"></i>
    </button>
    
    <div class="auth-container">
        <!-- Enhanced Background -->
        <div class="background-overlay"></div>
        <div class="background-gradient"></div>
        
        <!-- Enhanced floating particles -->
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        
        <!-- Additional decorative floating shapes -->
        <div class="floating-orb orb-1"></div>
        <div class="floating-orb orb-2"></div>
        <div class="floating-orb orb-3"></div>
        
        <div class="pill-navbar-wrapper">
            <nav class="pill-navbar">
                <div class="pill-left"><i class="fa-solid fa-feather"></i></div>
                {% if request.user.is_authenticated %}
                <a class="pill-link" href="{% url 'dashboard' %}">Dashboard</a>
                <a class="pill-link" href="{% url 'anime' %}">Anime API</a>
                <a class="pill-link" href="{% url 'jokes' %}">Jokes</a>
                <a class="pill-link" href="{% url 'cryptography' %}">Crypto</a>
                <a class="pill-link" href="{% url 'automation' %}">Automation</a>
                <a class="pill-link" href="{% url 'exercises_page' %}">Exercises</a>
                <a class="pill-link" href="{% url 'settings' %}">Settings</a>
                {% else %}
                <a class="pill-link" href="{% url 'login' %}">Login</a>
                <a class="pill-link" href="{% url 'register' %}">Register</a>
                {% endif %}
                <div class="pill-spacer"></div>
                {% if request.user.is_authenticated %}
                <a href="{% url 'logout' %}" onclick="return confirmLogout(event)" class="logout-btn" title="Logout">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <span class="logout-text">Logout</span>
                </a>
                {% else %}
                <a href="{% url 'login' %}" class="login-btn">Sign in</a>
                {% endif %}
            </nav>
        </div>
        <div class="auth-card">
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {% if message.tags == 'success' %}
                            <i class="fa-solid fa-circle-check alert-icon"></i>
                        {% elif message.tags == 'error' or message.tags == 'danger' %}
                            <i class="fa-solid fa-triangle-exclamation alert-icon"></i>
                        {% elif message.tags == 'warning' %}
                            <i class="fa-solid fa-circle-exclamation alert-icon"></i>
                        {% elif message.tags == 'info' %}
                            <i class="fa-solid fa-circle-info alert-icon"></i>
                        {% else %}
                            <i class="fa-solid fa-bell alert-icon"></i>
                        {% endif %}
                        <span class="alert-content">{{ message }}</span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
            
            {% block content %}
            {% endblock %}
        </div>
    </div>
    
    <!-- Inline SVG sprite: custom 2D offline icons -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
        <symbol id="ico-bell" viewBox="0 0 24 24">
            <path d="M12 22a2 2 0 0 0 2-2h-4a2 2 0 0 0 2 2ZM20 16H4l2-2v-4a6 6 0 1 1 12 0v4l2 2Z"/>
        </symbol>
        <symbol id="ico-dumbbell" viewBox="0 0 24 24">
            <path d="M3 10h2v4H3v-4Zm2-2h2v8H5V8Zm4 3h6v2H9v-2Zm8-3h2v8h-2V8Zm2 2h2v4h-2v-4Z"/>
        </symbol>
        <symbol id="ico-lock" viewBox="0 0 24 24">
            <path d="M17 8h-1V6a4 4 0 0 0-8 0v2H7a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2Zm-6 0V6a2 2 0 1 1 4 0v2h-4Z"/>
        </symbol>
        <symbol id="ico-laugh" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm-4 7h2v2H8V9Zm8 0h-2v2h2V9Zm-8 6h8a4 4 0 0 1-8 0Z"/>
        </symbol>
        <symbol id="ico-play" viewBox="0 0 24 24">
            <path d="M8 5v14l11-7L8 5Z"/>
        </symbol>
        <symbol id="ico-clock" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm1 11h4v-2h-3V7h-2v6Z"/>
        </symbol>
        <symbol id="ico-qrcode" viewBox="0 0 24 24">
            <path d="M3 3h8v8H3V3Zm2 2v4h4V5H5Zm6 0h2v2h-2V5Zm0 4h2v2h-2V9Zm-6 6h2v2H5v-2Zm0-2h4v2H5v-2Zm6 2h2v4h-2v-4Zm2 0h2v2h-2v-2Zm2 2h4v2h-4v-2Zm0-2h2v2h-2v-2ZM13 3h4v2h-4V3Zm4 2h2v4h-2V5Zm-2 4h2v2h-2V9Z"/>
        </symbol>
        <symbol id="ico-shield" viewBox="0 0 24 24">
            <path d="M12 2 4 5v6c0 5 3.4 8.8 8 11 4.6-2.2 8-6 8-11V5l-8-3Z"/>
        </symbol>
        <symbol id="ico-search" viewBox="0 0 24 24">
            <path d="M10 2a8 8 0 1 0 4.9 14.3l4.4 4.4 1.4-1.4-4.4-4.4A8 8 0 0 0 10 2Zm0 2a6 6 0 1 1 0 12A6 6 0 0 1 10 4Z"/>
        </symbol>
        <symbol id="ico-gear" viewBox="0 0 24 24">
            <path d="M12 8a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm9 4-2.1-.8.4-2.2-2-1.2-1.4 1.7-2-.7-.7-2H10l-.7 2-2 .7-1.4-1.7-2 1.2.4 2.2L2 12l.8 2.1-2.2.4 1.2 2 1.7-1.4.7 2 .7 2H14l.7-2 2-.7 1.7 1.4 1.2-2-2.2-.4.8-2.1Z"/>
        </symbol>
        <symbol id="ico-inbox" viewBox="0 0 24 24">
            <path d="M4 4h16l2 10h-6l-2 3h-4l-2-3H2L4 4Zm0 10h4l2 3h4l2-3h4l-1.6-8H5.6L4 14Z"/>
        </symbol>
        <symbol id="ico-external" viewBox="0 0 24 24">
            <path d="M14 3h7v7h-2V6.4l-9.3 9.3-1.4-1.4L17.6 5H14V3ZM5 5h6v2H7v10h10v-4h2v6H5V5Z"/>
        </symbol>
        <symbol id="ico-info" viewBox="0 0 24 24">
            <path d="M11 17h2v-6h-2v6Zm0-8h2V7h-2v2Zm1-7a10 10 0 1 0 0 20 10 10 0 0 0 0-20Z"/>
        </symbol>
        <symbol id="ico-warning" viewBox="0 0 24 24">
            <path d="M1 21h22L12 2 1 21Zm12-3h-2v-2h2v2Zm0-4h-2v-4h2v4Z"/>
        </symbol>
        <symbol id="ico-check" viewBox="0 0 24 24">
            <path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2Z"/>
        </symbol>
        <symbol id="ico-x" viewBox="0 0 24 24">
            <path d="M6 6l12 12-1.4 1.4L4.6 7.4 6 6Zm12 0L6 18l-1.4-1.4L16.6 4.6 18 6Z"/>
        </symbol>
        <symbol id="ico-signout" viewBox="0 0 24 24">
            <path d="M10 3h2v6H10V3Zm5.6 4.6 1.4 1.4-3.6 3.6 3.6 3.6-1.4 1.4L12.8 14H8v-2h4.8l2.8-2.8ZM4 5h4v2H6v10h2v2H4V5Z"/>
        </symbol>
        <symbol id="ico-feather" viewBox="0 0 24 24">
            <path d="M20 2S9 3 6 6s-4 7-4 7l9 9s4-1 7-4 4-14 4-14l-2-2ZM8 10l6 6"/>
        </symbol>
        <symbol id="ico-palette" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 0 20h1a3 3 0 0 0 0-6h-1a2 2 0 0 1-2-2V9a7 7 0 0 1 7-7h-5ZM7 8a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3Zm4-1a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3Zm6 2a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3Z"/>
        </symbol>
        <symbol id="ico-bolt" viewBox="0 0 24 24">
            <path d="M13 2 3 14h7l-1 8 10-12h-7l1-8Z"/>
        </symbol>
        <symbol id="ico-water" viewBox="0 0 24 24">
            <path d="M12 2s7 7 7 12a7 7 0 1 1-14 0C5 9 12 2 12 2Z"/>
        </symbol>
        <symbol id="ico-sun" viewBox="0 0 24 24">
            <path d="M12 4V2m0 20v-2M4 12H2m20 0h-2M5 5 3.6 3.6M20.4 20.4 19 19M5 19 3.6 20.4M20.4 3.6 19 5"/><circle cx="12" cy="12" r="4"/>
        </symbol>
        <symbol id="ico-moon" viewBox="0 0 24 24">
            <path d="M21 12.8A9 9 0 1 1 11.2 3 7 7 0 0 0 21 12.8Z"/>
        </symbol>
        <symbol id="ico-user" viewBox="0 0 24 24">
            <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 3-9 6v2h18v-2c0-3-4-6-9-6Z"/>
        </symbol>
        <symbol id="ico-circle-user" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm0 5a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm0 12a7 7 0 0 1-5.6-2.8C7.2 14.7 9.5 14 12 14s4.8.7 5.6 2.2A7 7 0 0 1 12 19Z"/>
        </symbol>
        <symbol id="ico-key" viewBox="0 0 24 24">
            <path d="M14 3a5 5 0 1 0 4.9 6H22v3h-2v2h-2v2h-2v-3.1A5 5 0 0 0 14 3Zm0 2a3 3 0 1 1 0 6 3 3 0 0 1 0-6Z"/>
        </symbol>
        <symbol id="ico-eye" viewBox="0 0 24 24">
            <path d="M12 5C7 5 2.7 8 1 12c1.7 4 6 7 11 7s9.3-3 11-7c-1.7-4-6-7-11-7Zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10Z"/>
        </symbol>
        <symbol id="ico-eye-slash" viewBox="0 0 24 24">
            <path d="M3 3 21 21l-1.4 1.4-2.1-2.1C15.9 21 14 22 12 22 7 22 2.7 19 1 15c.8-1.9 2.1-3.6 3.7-4.9L1.6 6.4 3 5l3 3A10 10 0 0 1 12 7c5 0 9.3 3 11 7-.7 1.7-1.7 3.2-3 4.5L16.6 12A5 5 0 0 0 9.9 9.9L7.1 7.1 3 3Z"/>
        </symbol>
        <symbol id="ico-magic" viewBox="0 0 24 24">
            <path d="M3 21 21 3l-2-2L1 19l2 2Zm10-10 2 2 6-6-2-2-6 6Z"/>
        </symbol>
        <symbol id="ico-share" viewBox="0 0 24 24">
            <path d="M18 8a3 3 0 1 0-2.8-4H13v2h2.2A3 3 0 0 0 18 8ZM6 16a3 3 0 1 0 2.8 4H11v-2H8.8A3 3 0 0 0 6 16Zm12-2H6v2h12v-2Z"/>
        </symbol>
        <symbol id="ico-quote-left" viewBox="0 0 24 24">
            <path d="M9 7H5v6h6V7H9Zm10 0h-4v6h6V7h-2Z"/>
        </symbol>
        <symbol id="ico-quote-right" viewBox="0 0 24 24">
            <path d="M9 11H3v6h6v-6Zm12 0h-6v6h6v-6Z"/>
        </symbol>
        <symbol id="ico-download" viewBox="0 0 24 24">
            <path d="M12 3v10l3-3 1.4 1.4L12 17l-4.4-5.6L9 10l3 3V3h0ZM4 19h16v2H4v-2Z"/>
        </symbol>
        <symbol id="ico-history" viewBox="0 0 24 24">
            <path d="M3 3v6h2V6.3A9 9 0 1 0 3 12H1A11 11 0 1 1 3 3Zm8 3h2v6h5v2h-7V6Z"/>
        </symbol>
        <symbol id="ico-trash" viewBox="0 0 24 24">
            <path d="M6 7h12l-1 14H7L6 7Zm3-3h6l1 2H8l1-2Z"/>
        </symbol>
        <symbol id="ico-trash-can" viewBox="0 0 24 24">
            <path d="M9 3h6l1 2h4v2H4V5h4l1-2Zm-1 6h2v10H8V9Zm4 0h2v10h-2V9Z"/>
        </symbol>
        <symbol id="ico-plus" viewBox="0 0 24 24">
            <path d="M11 11V4h2v7h7v2h-7v7h-2v-7H4v-2h7Z"/>
        </symbol>
        <symbol id="ico-eraser" viewBox="0 0 24 24">
            <path d="M16 3 21 8l-9 9H6L3 14l9-9h4Zm-9 9 2 2 7-7-2-2-7 7Zm6 7h8v2h-8v-2Z"/>
        </symbol>
        <symbol id="ico-chevron-left" viewBox="0 0 24 24">
            <path d="M15.4 5.4 14 4 7 11l7 7 1.4-1.4L9.8 11l5.6-5.6Z"/>
        </symbol>
        <symbol id="ico-chevron-right" viewBox="0 0 24 24">
            <path d="M8.6 18.6 10 20l7-7-7-7-1.4 1.4 5.6 5.6-5.6 5.6Z"/>
        </symbol>
        <symbol id="ico-rotate-right" viewBox="0 0 24 24">
            <path d="M12 6V2l5 5-5 5V8a5 5 0 1 0 5 5h2a7 7 0 1 1-7-7Z"/>
        </symbol>
        <symbol id="ico-copy" viewBox="0 0 24 24">
            <path d="M8 8h12v12H8V8Zm-4 8h2V6h10V4H4v12Z"/>
        </symbol>
        <symbol id="ico-facebook" viewBox="0 0 24 24">
            <path d="M13 22v-8h3l1-3h-4V8a1 1 0 0 1 1-1h3V4h-3a4 4 0 0 0-4 4v3H7v3h3v8h3Z"/>
        </symbol>
        <symbol id="ico-circle" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="8"/>
        </symbol>
        <symbol id="ico-pen" viewBox="0 0 24 24">
            <path d="M3 17.2V21h3.8L19 8.8 15.2 5 3 17.2Zm15.7-9 2.1-2.1L18 3l-2.1 2.1 2.8 3.1Z"/>
        </symbol>
        <symbol id="ico-output" viewBox="0 0 24 24">
            <path d="M7 11h10v2H7v-2Zm-4 0h2v2H3v-2Zm16-2h2v6h-2V9Z"/>
        </symbol>
        <symbol id="ico-user-plus" viewBox="0 0 24 24">
            <path d="M12 13a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm-8 7v-2c0-3.3 4-5 8-5s8 1.7 8 5v2H4Zm14-9V9h-2V7h2V5h2v2h2v2h-2v2h-2Z"/>
        </symbol>
        <symbol id="ico-signin" viewBox="0 0 24 24">
            <path d="M12 3h2v6h-2V3ZM8.4 8.6 10 7l6 6-6 6-1.6-1.6L12.8 14H4v-2h8.8L8.4 8.6ZM18 5h-2V3h4v18h-4v-2h2V5Z"/>
        </symbol>
        <symbol id="ico-smile" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm-4 7h2v2H8V9Zm8 0h-2v2h2V9Zm-8 5a5 5 0 0 0 8 0H8Z"/>
        </symbol>
        <symbol id="ico-laugh-beam" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm-5 9 3-1-3-1v2Zm10 0v-2l-3 1 3 1Zm-8 4h6a4 4 0 0 1-6 0Z"/>
        </symbol>
        <symbol id="ico-laugh-squint" viewBox="0 0 24 24">
            <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20ZM7 9l2 2 2-2H7Zm10 0h-4l2 2 2-2Zm-10 6h10a5 5 0 0 1-10 0Z"/>
        </symbol>
    </svg>

    <style>
        .icon { width: 1em; height: 1em; fill: currentColor; vertical-align: -.125em; }
        .icon-2x { width: 2em; height: 2em; }
    </style>
    
    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="logout-modal">
        <div class="logout-modal-content">
            <i class="fa-solid fa-triangle-exclamation logout-modal-icon"></i>
            <h3>Confirm Logout</h3>
            <p>Are you sure you want to log out? You'll need to sign in again to access your account.</p>
            <div class="logout-modal-buttons">
                <button class="logout-confirm-btn" onclick="proceedLogout()">
                    <i class="fa-solid fa-right-from-bracket"></i> Yes, Logout
                </button>
                <button class="logout-cancel-btn" onclick="cancelLogout()">
                    <i class="fa-solid fa-xmark"></i> Cancel
                </button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Enhanced Color Scheme Toggle
        let currentColorScheme = 0;
        const colorSchemes = [
            { name: 'default', icon: 'fa-solid fa-palette' },
            { name: 'neon', icon: 'fa-solid fa-bolt' },
            { name: 'ocean', icon: 'fa-solid fa-water' },
            { name: 'sunset', icon: 'fa-solid fa-sun' }
        ];
        
        /* Enhanced Theme Toggle Functionality */
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            // Add transition class for smooth theme switching
            document.documentElement.classList.add('theme-transitioning');
            
            // Set new theme
            document.documentElement.setAttribute('data-theme', newTheme);
            
            // Store theme preference
            localStorage.setItem('theme', newTheme);
            
            // Update background and icon
            updateBackground(newTheme);
            updateThemeIcon(newTheme);
            
            // Remove transition class after animation
            setTimeout(() => {
                document.documentElement.classList.remove('theme-transitioning');
                // Re-adjust form text colors after theme change
                adjustFormTextColors();
            }, 300);
            
            console.log('Theme switched to:', newTheme);
        }
        
        function updateBackground(theme) {
            const body = document.body;
            const gradient = getComputedStyle(document.documentElement).getPropertyValue('--bg-gradient').trim();
            if (gradient) {
                body.style.background = gradient;
            }
        }
        
        // Initialize theme on page load
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateBackground(savedTheme);
            updateThemeIcon(savedTheme);
        }
        
        // Update theme icon based on current theme
        function updateThemeIcon(theme) {
            const themeIcon = document.getElementById('theme-icon');
            if (themeIcon) {
                if (theme === 'dark') {
                    themeIcon.className = 'fa-solid fa-sun';
                } else {
                    themeIcon.className = 'fa-solid fa-moon';
                }
            }
        }
        
        
        // Load saved theme on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            try { transformIconsToCustom(); } catch (e) { console.warn('Icon transform failed', e); }
            try { highlightActiveNav(); } catch (e) { console.warn('Active nav failed', e); }
        });

        // Replace Font Awesome <i> with custom inline SVG icons (offline)
        function transformIconsToCustom() {
            const map = {
                'fa-bell': 'ico-bell',
                'fa-dumbbell': 'ico-dumbbell',
                'fa-lock': 'ico-lock',
                'fa-face-laugh': 'ico-laugh', 'fa-laugh': 'ico-laugh',
                'fa-circle-play': 'ico-play', 'fa-play-circle': 'ico-play',
                'fa-clock': 'ico-clock',
                'fa-qrcode': 'ico-qrcode',
                'fa-shield-halved': 'ico-shield', 'fa-shield-alt': 'ico-shield',
                'fa-magnifying-glass': 'ico-search', 'fa-search': 'ico-search',
                'fa-gear': 'ico-gear', 'fa-cog': 'ico-gear',
                'fa-inbox': 'ico-inbox',
                'fa-up-right-from-square': 'ico-external', 'fa-external-link-alt': 'ico-external',
                'fa-circle-info': 'ico-info', 'fa-info-circle': 'ico-info',
                'fa-triangle-exclamation': 'ico-warning', 'fa-exclamation-triangle': 'ico-warning',
                'fa-circle-check': 'ico-check', 'fa-check-circle': 'ico-check',
                'fa-xmark': 'ico-x', 'fa-times': 'ico-x',
                'fa-right-from-bracket': 'ico-signout', 'fa-sign-out-alt': 'ico-signout',
                'fa-feather': 'ico-feather',
                'fa-palette': 'ico-palette',
                'fa-bolt': 'ico-bolt',
                'fa-water': 'ico-water',
                'fa-sun': 'ico-sun',
                'fa-moon': 'ico-moon',
                'fa-user': 'ico-user',
                'fa-circle-user': 'ico-circle-user', 'fa-user-circle': 'ico-circle-user',
                'fa-key': 'ico-key',
                'fa-eye': 'ico-eye',
                'fa-eye-slash': 'ico-eye-slash',
                'fa-wand-magic-sparkles': 'ico-magic', 'fa-magic': 'ico-magic',
                'fa-share-nodes': 'ico-share', 'fa-share-alt': 'ico-share',
                'fa-quote-left': 'ico-quote-left',
                'fa-quote-right': 'ico-quote-right',
                'fa-download': 'ico-download',
                'fa-clock-rotate-left': 'ico-history', 'fa-history': 'ico-history',
                'fa-trash': 'ico-trash', 'fa-trash-alt': 'ico-trash-can', 'fa-trash-can': 'ico-trash-can',
                'fa-plus': 'ico-plus',
                'fa-eraser': 'ico-eraser',
                'fa-chevron-left': 'ico-chevron-left',
                'fa-chevron-right': 'ico-chevron-right',
                'fa-rotate-right': 'ico-rotate-right', 'fa-sync-alt': 'ico-rotate-right',
                'fa-copy': 'ico-copy'
                , 'fa-facebook': 'ico-facebook', 'fa-facebook-f': 'ico-facebook'
                , 'fa-circle': 'ico-circle'
                , 'fa-pen-to-square': 'ico-pen', 'fa-edit': 'ico-pen'
                , 'fa-output': 'ico-output'
                , 'fa-user-plus': 'ico-user-plus'
                , 'fa-sign-in-alt': 'ico-signin'
                , 'fa-face-smile': 'ico-smile', 'fa-smile': 'ico-smile'
                , 'fa-face-laugh-beam': 'ico-laugh-beam'
                , 'fa-face-laugh-squint': 'ico-laugh-squint'
            };
            const candidates = Array.from(document.querySelectorAll('i[class*="fa-"]'));
            candidates.forEach(i => {
                const cls = Array.from(i.classList);
                const match = cls.find(c => c.startsWith('fa-') && c !== 'fa' && c !== 'fa-solid' && c !== 'fa-regular' && c !== 'fa-brands');
                if (!match) return;
                const id = map[match];
                if (!id) return;
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.setAttribute('class', 'icon');
                svg.setAttribute('aria-hidden', 'true');
                const use = document.createElementNS('http://www.w3.org/2000/svg', 'use');
                use.setAttributeNS('http://www.w3.org/1999/xlink', 'href', `#${id}`);
                svg.appendChild(use);
                i.replaceWith(svg);
            });
        }

        // Observe DOM changes to convert late-rendered icons too
        const _iconObserver = new MutationObserver((mutations) => {
            for (const m of mutations) {
                if (m.addedNodes && m.addedNodes.length) {
                    try { transformIconsToCustom(); } catch (_) {}
                }
            }
        });
        document.addEventListener('DOMContentLoaded', () => {
            try { _iconObserver.observe(document.body, { childList: true, subtree: true }); } catch (_) {}
        });

        function highlightActiveNav() {
            const path = window.location.pathname;
            const map = [
                { selector: '.pill-link[href$="/dashboard/"]', match: /^\/dashboard\/?$/ },
                { selector: '.pill-link[href$="/anime/"]', match: /^\/anime\/?$/ },
                { selector: '.pill-link[href$="/jokes/"]', match: /^\/jokes\/?$/ },
                { selector: '.pill-link[href$="/cryptography/"]', match: /^\/cryptography\/?$/ },
                { selector: '.pill-link[href$="/automation/"]', match: /^\/automation\/?$/ },
                { selector: '.pill-link[href$="/exercises/"]', match: /^\/exercises\/?$/ },
                { selector: '.pill-link[href$="/settings/"]', match: /^\/settings(\/.*)?$/ },
                { selector: '.pill-link[href$="/login/"]', match: /^\/login\/?$/ },
                { selector: '.pill-link[href$="/register/"]', match: /^\/register\/?$/ }
            ];
            map.forEach(item => {
                try {
                    const el = document.querySelector(item.selector);
                    if (el && item.match.test(path)) {
                        el.classList.add('active');
                    }
                } catch(_){}
            });
        }
        
        // Logout confirmation functionality
        let logoutUrl = '';
        
        function confirmLogout(event) {
            event.preventDefault();
            // Get the anchor element even if icon/span inside was clicked
            const linkEl = event.currentTarget || (event.target && event.target.closest ? event.target.closest('a') : null);
            logoutUrl = linkEl && linkEl.href ? linkEl.href : '';
            const modal = document.getElementById('logoutModal');
            modal.classList.add('show');
            return false;
        }
        
        function proceedLogout() {
            if (logoutUrl) {
                window.location.href = logoutUrl;
            }
        }
        
        function cancelLogout() {
            const modal = document.getElementById('logoutModal');
            modal.classList.remove('show');
            logoutUrl = '';
        }
        
        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('logoutModal');
            if (event.target === modal) {
                cancelLogout();
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modal = document.getElementById('logoutModal');
                if (modal.classList.contains('show')) {
                    cancelLogout();
                }
            }
        });
        
        // Smart form background detection and text color adjustment
        function adjustFormTextColors() {
            const formControls = document.querySelectorAll('.form-control, input, textarea');
            
            formControls.forEach(control => {
                // Get computed background color
                const computedStyle = window.getComputedStyle(control);
                const bgColor = computedStyle.backgroundColor;
                
                // Convert rgba to rgb values for brightness calculation
                const rgbMatch = bgColor.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);
                
                if (rgbMatch) {
                    const r = parseInt(rgbMatch[1]);
                    const g = parseInt(rgbMatch[2]);
                    const b = parseInt(rgbMatch[3]);
                    const a = rgbMatch[4] ? parseFloat(rgbMatch[4]) : 1;
                    
                    // Calculate brightness (0-255, where >128 is considered light)
                    const brightness = (r * 0.299 + g * 0.587 + b * 0.114);
                    
                    // If background is light or very transparent, use dark text
                    if (brightness > 128 || a < 0.5) {
                        control.classList.remove('dark-bg');
                        control.style.color = '#000000';
                    } else {
                        // If background is dark, use light text
                        control.classList.add('dark-bg');
                        control.style.color = '#ffffff';
                    }
                }
            });
        }
        
        // Enhanced form interactions
        document.addEventListener('DOMContentLoaded', function() {
            const formControls = document.querySelectorAll('.form-control');
            
            // Apply smart text colors
            setTimeout(adjustFormTextColors, 100); // Small delay to ensure styles are loaded
            
            formControls.forEach(control => {
                control.addEventListener('focus', function() {
                    this.parentElement.classList.add('focused');
                });
                
                control.addEventListener('blur', function() {
                    if (!this.value) {
                        this.parentElement.classList.remove('focused');
                    }
                });
            });
            
            // Password toggle functionality
            const passwordToggles = document.querySelectorAll('.password-toggle-btn');
            passwordToggles.forEach(toggle => {
                toggle.addEventListener('click', function() {
                    const passwordInput = this.parentElement.querySelector('input[type="password"], input[type="text"]');
                    const icon = this.querySelector('i');
                    
                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        icon.className = 'fa-solid fa-eye-slash';
                        this.setAttribute('aria-label', 'Hide password');
                    } else {
                        passwordInput.type = 'password';
                        icon.className = 'fa-solid fa-eye';
                        this.setAttribute('aria-label', 'Show password');
                    }
                });
            });
        });
        
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
    <script>
    // Auto-dismiss success and warning alerts after 3 seconds
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(function() {
            try {
                var alerts = document.querySelectorAll('.alert-success, .alert-warning');
                alerts.forEach(function(el){
                    try {
                        var inst = bootstrap.Alert.getOrCreateInstance(el);
                        inst.close();
                    } catch(_) {
                        // Fallback: remove element
                        el.parentNode && el.parentNode.removeChild(el);
                    }
                });
            } catch(_) {}
        }, 3000);
    });
    </script>
    
    {% block extra_js %}
    {% endblock %}
</body>
</html>
