{% extends 'base.html' %}

{% block title %}Debug QR Code - Django Authentication{% endblock %}

{% block content %}
<div class="text-center mb-4">
    <h2><i class="fa-solid fa-bug text-warning"></i> QR Code Debug Information</h2>
    <p class="text-muted">Debug information for QR code authentication</p>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fa-solid fa-user"></i> User Information</h5>
            </div>
            <div class="card-body">
                <p><strong>Username:</strong> {{ user.username }}</p>
                <p><strong>Email:</strong> {{ user.email }}</p>
                <p><strong>QR Enabled:</strong> 
                    {% if qr_enabled %}
                        <span class="text-success">Yes</span>
                    {% else %}
                        <span class="text-warning">No</span>
                    {% endif %}
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5><i class="fa-solid fa-key"></i> QR Secret Information</h5>
            </div>
            <div class="card-body">
                <p><strong>QR Secret Key:</strong></p>
                <code>{{ qr_secret|default:"Not generated" }}</code>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fa-solid fa-qrcode"></i> QR Code Image</h5>
            </div>
            <div class="card-body text-center">
                {% if qr_image %}
                    <p><strong>QR Code Image Path:</strong> {{ qr_image.url }}</p>
                    <div class="qr-code-container">
                        <h6>Scan this QR code with Google Authenticator:</h6>
                        <img src="{{ qr_image.url }}" alt="QR Code" class="img-fluid" style="max-width: 300px;">
                    </div>
                    <div class="mt-3">
                        <a href="{{ qr_image.url }}" target="_blank" class="btn btn-outline-primary">
                            <i class="fa-solid fa-up-right-from-square"></i> Open QR Code in New Tab
                        </a>
                    </div>
                {% else %}
                    <div class="alert alert-warning">
                        <i class="fa-solid fa-triangle-exclamation"></i>
                        No QR code image found. 
                        <a href="{% url 'setup_qr' %}" class="btn btn-sm btn-primary">Generate QR Code</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="d-grid gap-2 mt-4">
    <a href="{% url 'setup_qr' %}" class="btn btn-primary">
        <i class="fa-solid fa-gear"></i> Go to QR Setup
    </a>
    <a href="{% url 'dashboard' %}" class="btn btn-outline-secondary">
        <i class="fa-solid fa-arrow-left"></i> Back to Dashboard
    </a>
</div>
{% endblock %}
